SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #1 : Create CALENDAR table.
SQL> -- --------------------------------------------------------------------------------
SQL> -- Conditionally drop table.
SQL> BEGIN
  2    FOR i IN (SELECT table_name
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'CALENDAR') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE '||i.table_name||' CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT sequence_name
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'CALENDAR_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE '||i.sequence_name;
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #1 : Create the CALENDAR table.
SQL> -- --------------------------------------------------------------------------------
SQL> CREATE TABLE calendar (
  2    calendar_id		 NUMBER
  3  , calendar_name	    VARCHAR2(10) CONSTRAINT nn_calendar_1 NOT NULL
  4  , calendar_short_name   VARCHAR2(3) CONSTRAINT nn_calendar_2 NOT NULL
  5  , start_date		    DATE CONSTRAINT nn_calendar_3 NOT NULL
  6  , end_date 		    DATE CONSTRAINT nn_calendar_4 NOT NULL
  7  , created_by		  NUMBER CONSTRAINT nn_calendar_5 NOT NULL
  8  , creation_date		    DATE CONSTRAINT nn_calendar_6 NOT NULL
  9  , last_updated_by		  NUMBER CONSTRAINT nn_calendar_7 NOT NULL
 10  , last_update_date 	    DATE CONSTRAINT nn_calendar_8 NOT NULL
 11  , CONSTRAINT pk_calendar_1  PRIMARY KEY(calendar_id)
 12  , CONSTRAINT fk_calendar_1  FOREIGN KEY(created_by)      REFERENCES system_user(system_user_id)
 13  , CONSTRAINT fk_calendar_2  FOREIGN KEY(last_updated_by) REFERENCES system_user(system_user_id)
 14  );

Table created.

SQL> 
SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #1 : Create the CALENDAR sequence.
SQL> -- --------------------------------------------------------------------------------
SQL> CREATE SEQUENCE calendar_s1
  2  START WITH      1001
  3  INCREMENT BY    1;

Sequence created.

SQL> 
SQL> 
SQL> -- Display the table organization.
SQL> SET NULL ''
SQL> COLUMN table_name	 FORMAT A16
SQL> COLUMN column_id	 FORMAT 9999
SQL> COLUMN column_name  FORMAT A22
SQL> COLUMN data_type	 FORMAT A12
SQL> SELECT   table_name
  2  ,	      column_id
  3  ,	      column_name
  4  ,	      CASE
  5  		WHEN nullable = 'N' THEN 'NOT NULL'
  6  		ELSE ''
  7  	      END AS nullable
  8  ,	      CASE
  9  		WHEN data_type IN ('CHAR','VARCHAR2','NUMBER') THEN
 10  		  data_type||'('||data_length||')'
 11  		ELSE
 12  		  data_type
 13  	      END AS data_type
 14  FROM     user_tab_columns
 15  WHERE    table_name = 'CALENDAR'
 16  ORDER BY 2;

TABLE NAME       COLUMN_ID COLUMN NAME            NULLABLE DATA_TYPE                                                                                  
---------------- --------- ---------------------- -------- ------------                                                                               
CALENDAR                 1 CALENDAR_ID            NOT NULL NUMBER(22)                                                                                 
CALENDAR                 2 CALENDAR_NAME          NOT NULL VARCHAR2(10)                                                                               
CALENDAR                 3 CALENDAR_SHORT_NAME    NOT NULL VARCHAR2(3)                                                                                
CALENDAR                 4 START_DATE             NOT NULL DATE                                                                                       
CALENDAR                 5 END_DATE               NOT NULL DATE                                                                                       
CALENDAR                 6 CREATED_BY             NOT NULL NUMBER(22)                                                                                 
CALENDAR                 7 CREATION_DATE          NOT NULL DATE                                                                                       
CALENDAR                 8 LAST_UPDATED_BY        NOT NULL NUMBER(22)                                                                                 
CALENDAR                 9 LAST_UPDATE_DATE       NOT NULL DATE                                                                                       

9 rows selected.

SQL> 
SQL> -- Display non-unique constraints.
SQL> COLUMN constraint_name   FORMAT A22  HEADING "Constraint Name"
SQL> COLUMN search_condition  FORMAT A36  HEADING "Search Condition"
SQL> COLUMN constraint_type   FORMAT A1   HEADING "C|T"
SQL> SELECT   uc.constraint_name
  2  ,	      uc.search_condition
  3  ,	      uc.constraint_type
  4  FROM     user_constraints uc INNER JOIN user_cons_columns ucc
  5  ON       uc.table_name = ucc.table_name
  6  AND      uc.constraint_name = ucc.constraint_name
  7  WHERE    uc.table_name = UPPER('calendar')
  8  AND      uc.constraint_type IN (UPPER('c'),UPPER('p'))
  9  ORDER BY uc.constraint_type DESC
 10  ,	      uc.constraint_name;

                                                            C                                                                                         
Constraint Name        Search Condition                     T                                                                                         
---------------------- ------------------------------------ -                                                                                         
PK_CALENDAR_1                                               P                                                                                         
NN_CALENDAR_1          "CALENDAR_NAME" IS NOT NULL          C                                                                                         
NN_CALENDAR_2          "CALENDAR_SHORT_NAME" IS NOT NULL    C                                                                                         
NN_CALENDAR_3          "START_DATE" IS NOT NULL             C                                                                                         
NN_CALENDAR_4          "END_DATE" IS NOT NULL               C                                                                                         
NN_CALENDAR_5          "CREATED_BY" IS NOT NULL             C                                                                                         
NN_CALENDAR_6          "CREATION_DATE" IS NOT NULL          C                                                                                         
NN_CALENDAR_7          "LAST_UPDATED_BY" IS NOT NULL        C                                                                                         
NN_CALENDAR_8          "LAST_UPDATE_DATE" IS NOT NULL       C                                                                                         

9 rows selected.

SQL> 
SQL> -- Display foreign key constraints.
SQL> COL constraint_source FORMAT A38 HEADING "Constraint Name:| Table.Column"
SQL> COL references_column FORMAT A40 HEADING "References:| Table.Column"
SQL> SELECT   uc.constraint_name||CHR(10)
  2  ||      '('||ucc1.table_name||'.'||ucc1.column_name||')' constraint_source
  3  ,	     'REFERENCES'||CHR(10)
  4  ||      '('||ucc2.table_name||'.'||ucc2.column_name||')' references_column
  5  FROM     user_constraints uc
  6  ,	      user_cons_columns ucc1
  7  ,	      user_cons_columns ucc2
  8  WHERE    uc.constraint_name = ucc1.constraint_name
  9  AND      uc.r_constraint_name = ucc2.constraint_name
 10  AND      ucc1.position = ucc2.position -- Correction for multiple column primary keys.
 11  AND      uc.constraint_type = 'R'
 12  AND      ucc1.table_name = 'CALENDAR'
 13  ORDER BY ucc1.table_name
 14  ,	      uc.constraint_name;

Constraint Name:                       References:                                                                                                    
 Table.Column                           Table.Column                                                                                                  
-------------------------------------- ----------------------------------------                                                                       
FK_CALENDAR_1                          REFERENCES                                                                                                     
(CALENDAR.CREATED_BY)                  (SYSTEM_USER.SYSTEM_USER_ID)                                                                                   
                                                                                                                                                      
FK_CALENDAR_2                          REFERENCES                                                                                                     
(CALENDAR.LAST_UPDATED_BY)             (SYSTEM_USER.SYSTEM_USER_ID)                                                                                   
                                                                                                                                                      

2 rows selected.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #2 : Seed CALENDAR table.
SQL> -- --------------------------------------------------------------------------------
SQL> 
SQL> -- Seed the table with 10 years of data.
SQL> DECLARE
  2    -- Create local collection data types.
  3    TYPE smonth IS TABLE OF VARCHAR2(3);
  4    TYPE lmonth IS TABLE OF VARCHAR2(9);
  5  
  6    -- Declare month arrays.
  7    short_month SMONTH := smonth('JAN','FEB','MAR','APR','MAY','JUN'
  8  				   ,'JUL','AUG','SEP','OCT','NOV','DEC');
  9    long_month  LMONTH := lmonth('January','February','March','April','May','June'
 10  				   ,'July','August','September','October','November','December');
 11  
 12    -- Declare base dates.
 13    start_date DATE := '01-JAN-09';
 14    end_date   DATE := '31-JAN-09';
 15  
 16    -- Declare years.
 17    month_id   NUMBER;
 18    years	  NUMBER := 1;
 19  
 20  BEGIN
 21  
 22    -- Loop through years and months.
 23    FOR i IN 1..years LOOP
 24  	 FOR j IN 1..short_month.COUNT LOOP
 25  	   -- Assign number from sequence.
 26  	   SELECT calendar_s1.nextval INTO month_id FROM dual;
 27  
 28  	   INSERT INTO calendar VALUES
 29  	   ( month_id
 30  	   , long_month(j)
 31  	   , short_month(j)
 32  	   , add_months(start_date,(j-1)+(12*(i-1)))
 33  	   , add_months(end_date,(j-1)+(12*(i-1)))
 34  	   , 1002
 35  	   , SYSDATE
 36  	   , 1002
 37  	   , SYSDATE);
 38  
 39  	 END LOOP;
 40    END LOOP;
 41  
 42  END;
 43  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Set output page break interval.
SQL> SET PAGESIZE 49999
SQL> 
SQL> -- Query the data insert.
SQL> COL calendar_name	      FORMAT A10  HEADING "Calendar|Name"
SQL> COL calendar_short_name  FORMAT A8  HEADING "Calendar|Short|Name"
SQL> COL start_date	      FORMAT A9   HEADING "Start|Date"
SQL> COL end_date	      FORMAT A9   HEADING "End|Date"
SQL> SELECT   calendar_name
  2  ,	      calendar_short_name
  3  ,	      start_date
  4  ,	      end_date
  5  FROM     calendar;

           Calendar                                                                                                                                   
Calendar   Short    Start     End                                                                                                                     
Name       Name     Date      Date                                                                                                                    
---------- -------- --------- ---------                                                                                                               
January    JAN      01-JAN-09 31-JAN-09                                                                                                               
February   FEB      01-FEB-09 28-FEB-09                                                                                                               
March      MAR      01-MAR-09 31-MAR-09                                                                                                               
April      APR      01-APR-09 30-APR-09                                                                                                               
May        MAY      01-MAY-09 31-MAY-09                                                                                                               
June       JUN      01-JUN-09 30-JUN-09                                                                                                               
July       JUL      01-JUL-09 31-JUL-09                                                                                                               
August     AUG      01-AUG-09 31-AUG-09                                                                                                               
September  SEP      01-SEP-09 30-SEP-09                                                                                                               
October    OCT      01-OCT-09 31-OCT-09                                                                                                               
November   NOV      01-NOV-09 30-NOV-09                                                                                                               
December   DEC      01-DEC-09 31-DEC-09                                                                                                               

12 rows selected.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #3 : Upload and transform data.
SQL> -- --------------------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop table.
SQL> SELECT 'Conditionally drop TRANSACTION_REVERSAL table.' AS "Statement" FROM dual;

Statement                                                                                                                                             
----------------------------------------------                                                                                                        
Conditionally drop TRANSACTION_REVERSAL table.                                                                                                        

1 row selected.

SQL> BEGIN
  2    FOR i IN (SELECT table_name
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'TRANSACTION_REVERSAL') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE '||i.table_name||' CASCADE CONSTRAINTS';
  6    END LOOP;
  7  END;
  8  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #3 : Upload and transform data.
SQL> -- --------------------------------------------------------------------------------
SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #3 : Create the TRANSACTION_REVERSAL table.
SQL> -- --------------------------------------------------------------------------------
SQL> CREATE TABLE transaction_reversal (
  2    transaction_id	      NUMBER
  3  , transaction_account    VARCHAR2(15)
  4  , transaction_type       NUMBER
  5  , transaction_date       DATE
  6  , transaction_amount     FLOAT
  7  , rental_id	      NUMBER
  8  , payment_method_type    NUMBER
  9  , payment_account_number VARCHAR2(19)
 10  , created_by	      NUMBER
 11  , creation_date	      DATE
 12  , last_updated_by	      NUMBER
 13  , last_update_date       DATE
 14  )
 15  ORGANIZATION EXTERNAL
 16  (
 17    TYPE oracle_loader
 18    DEFAULT DIRECTORY upload
 19    ACCESS PARAMETERS
 20    (
 21  	  RECORDS DELIMITED BY NEWLINE CHARACTERSET US7ASCII
 22  	  BADFILE     'UPLOAD':'transaction_upload2.bad'
 23  	  DISCARDFILE 'UPLOAD':'transaction_upload2.dis'
 24  	  LOGFILE     'UPLOAD':'transaction_upload2.log'
 25  	  FIELDS TERMINATED BY ','
 26  	  OPTIONALLY ENCLOSED BY "'"
 27  	  MISSING FIELD VALUES ARE NULL
 28    )
 29    LOCATION ('transaction_upload2.csv')
 30  )
 31  REJECT LIMIT UNLIMITED;

Table created.

SQL> 
SQL> -- Select the uploaded records.
SQL> SELECT COUNT(*) FROM transaction_reversal;

  COUNT(*)                                                                                                                                            
----------                                                                                                                                            
      1170                                                                                                                                            

1 row selected.

SQL> 
SQL> -- Select the uploaded records.
SQL> DELETE FROM transaction WHERE transaction_account = '222-222-222-222';

0 rows deleted.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #3 : Insert records into the TRANSACTION_REVERSAL table.
SQL> -- --------------------------------------------------------------------------------
SQL> -- Set environment variables.
SQL> SET LONG 100000
SQL> SET PAGESIZE 0
SQL> 
SQL> -- Set a local variable of a character large object (CLOB).
SQL> VARIABLE ddl_text CLOB
SQL> 
SQL> -- Get the internal DDL command for the TRANSACTION table from the data dictionary.
SQL> SELECT dbms_metadata.get_ddl('TABLE','TRANSACTION') FROM dual;
                                                                                                                                                      
  CREATE TABLE "STUDENT"."TRANSACTION"                                                                                                                
   (	"TRANSACTION_ID" NUMBER,                                                                                                                         
	"TRANSACTION_ACCOUNT" VARCHAR2(15) CONSTRAINT "                                                                                                      
NN_TRANSACTION_1" NOT NULL ENABLE,                                                                                                                    
	"TRANSACTION_TYPE" NUMBER CONSTRAINT "NN_TR                                                                                                          
ANSACTION_2" NOT NULL ENABLE,                                                                                                                         
	"TRANSACTION_DATE" DATE CONSTRAINT "NN_TRANSACTI                                                                                                     
ON_3" NOT NULL ENABLE,                                                                                                                                
	"TRANSACTION_AMOUNT" NUMBER CONSTRAINT "NN_TRANSACTION_                                                                                              
4" NOT NULL ENABLE,                                                                                                                                   
	"RENTAL_ID" NUMBER CONSTRAINT "NN_TRANSACTION_5" NOT NULL                                                                                            
ENABLE,                                                                                                                                               
	"PAYMENT_METHOD_TYPE" NUMBER CONSTRAINT "NN_TRANSA                                                                                                   
CTION_6" NOT NULL ENABLE,                                                                                                                             
	"PAYMENT_ACCOUNT_NUMBER" VARCHAR2(19) CONSTRAINT "NN                                                                                                 
_TRANSACTION_7" NOT NULL ENABLE,                                                                                                                      
	"CREATED_BY" NUMBER CONSTRAINT "NN_TRANSACTIO                                                                                                        
N_8" NOT NULL ENABLE,                                                                                                                                 
	"CREATION_DATE" DATE CONSTRAINT "NN_TRANSACTION_9" NOT N                                                                                             
ULL ENABLE,                                                                                                                                           
	"LAST_UPDATED_BY" NUMBER CONSTRAINT "NN_TRANSA                                                                                                       
CTION_10" NOT NULL ENABLE,                                                                                                                            
	"LAST_UPDATE_DATE" DATE CONSTRAINT "NN_TRANSACTION_                                                                                                  
11" NOT NULL ENABLE,                                                                                                                                  
	 CONSTRAINT "PK_TRANSACTION" PRIMARY KEY ("TRANSACTION_ID                                                                                            
")                                                                                                                                                    
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255                                                                                                      
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS                                                                                                       
 1 MAXEXTENTS 2147483645                                                                                                                              
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_PO                                                                                               
OL DEFAULT FLASH_CACHE DEFAULT CELL_FLAS                                                                                                              
H_CACHE DEFAULT)                                                                                                                                      
  TABLESPACE "USERS"  ENABLE,                                                                                                                         
	 CONSTRAINT "FK_TRANSACTION_1" FOREIGN KEY ("TRANSA                                                                                                  
CTION_TYPE")                                                                                                                                          
	  REFERENCES "STUDENT"."COMMON_LOOKUP" ("COMMO                                                                                                       
N_LOOKUP_ID") ENABLE,                                                                                                                                 
	 CONSTRAINT "FK_TRANSACTION_2" FOREIGN KEY ("RENTAL_ID")                                                                                             
                                                                                                                                                      
	  REFERENCES "STUDENT"."RENTAL" ("RENTAL_ID") ENABLE,                                                                                                
	 CONSTRAINT "FK_TRANSACTION_3" FOREIGN KEY                                                                                                           
 ("PAYMENT_METHOD_TYPE")                                                                                                                              
	  REFERENCES "STUDENT"."COMMON_LOOKUP" ("COMMON_LOOKUP                                                                                               
_ID") ENABLE,                                                                                                                                         
	 CONSTRAINT "FK_TRANSACTION_4" FOREIGN KEY (                                                                                                         
"CREATED_BY")                                                                                                                                         
	  REFERENCES "STUDENT"."SYSTEM_USER" ("SYSTEM                                                                                                        
_USER_ID") ENABLE,                                                                                                                                    
	 CONSTRAINT "FK_TRANSACTION_5" FOREIGN                                                                                                               
KEY ("LAST_UPDATED_BY")                                                                                                                               
	  REFERENCES "STUDENT"."SYSTEM_USER" ("SYSTEM_USER_ID")                                                                                              
 ENABLE                                                                                                                                               
   ) SEGMENT CREATION IMMEDIATE                                                                                                                       
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS                                                                                            
LOGGING                                                                                                                                               
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MA                                                                                                  
XEXTENTS 2147483645                                                                                                                                   
  PCTINCREASE 0 FREELISTS 1 FREELIST GRO                                                                                                              
UPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DE                                                                                                              
FAULT CELL_FLASH_CACHE DEFAULT)                                                                                                                       
  TABLESPACE "USERS"                                                                                                                                  
                                                                                                                                                      

1 row selected.

SQL> 
SQL> -- Get the internal DDL command for the external TRANSACTION_UPLOAD table from the data dictionary.
SQL> SELECT dbms_metadata.get_ddl('TABLE','TRANSACTION_UPLOAD') FROM dual;
                                                                                                                                                      
  CREATE TABLE "STUDENT"."TRANSACTION_UPLOAD"                                                                                                         
   (	"ACCOUNT_NUMBER" VARCHAR2(10),                                                                                                                   
	"FIRST_NAME" VARCHAR2(20),                                                                                                                           
	"MIDDLE_NAME" VARCHAR2(20),                                                                                                                          
	"LAST_NAME" VARCHAR2(20),                                                                                                                            
	"CHECK_OUT_DATE" DATE,                                                                                                                               
	"RETURN_DATE" DATE,                                                                                                                                  
	"RENTAL_ITEM_TYPE" VARCHAR2(12),                                                                                                                     
	"TRANSACTION_TYPE" VARCHAR2(14),                                                                                                                     
	"TRANSACTION_AMOUNT" NUMBER,                                                                                                                         
	"TRANSACTION_DATE" DATE,                                                                                                                             
	"ITEM_ID" NUMBER,                                                                                                                                    
	"PAYMENT_METHOD_TYPE" VARCHAR2(14),                                                                                                                  
	"PAYMENT_ACCOUNT_NUMBER" VARCHAR2(19)                                                                                                                
   )                                                                                                                                                  
   ORGANIZATION EXTERNAL                                                                                                                              
    ( TYPE ORACLE_LOADER                                                                                                                              
      DEFAULT DIRECTORY "UPLOAD"                                                                                                                      
      ACCESS PARAMETERS                                                                                                                               
      ( RECORDS DELIMITED BY NEWLINE CHARA                                                                                                            
CTERSET US7ASCII                                                                                                                                      
     BADFILE     'UPLOAD':'transaction_uplo                                                                                                           
ad.bad'                                                                                                                                               
     DISCARDFILE 'UPLOAD':'transaction_upload.dis'                                                                                                    
     LOGFILE     'UPLOAD':'transaction_up                                                                                                             
load.log'                                                                                                                                             
     FIELDS TERMINATED BY ','                                                                                                                         
     OPTIONALLY ENCLOSED BY "'"                                                                                                                       
     MISSING FIELD VALUES ARE NULL                                                                                                                    
      )                                                                                                                                               
      LOCATION                                                                                                                                        
       ( 'transaction_upload.csv'                                                                                                                     
       )                                                                                                                                              
    )                                                                                                                                                 
   REJECT LIMIT UNLIMITED                                                                                                                             
                                                                                                                                                      
                                                                                                                                                      

1 row selected.

SQL> 
SQL> INSERT INTO transaction (
  2  SELECT
  3    transaction_s1.NEXTVAL
  4  , transaction_account
  5  , transaction_type
  6  , transaction_date
  7  , transaction_amount / 1.06 AS transaction_amount
  8  , rental_id
  9  , payment_method_type
 10  , payment_account_number
 11  , 1001
 12  , creation_date
 13  , 1001
 14  , last_update_date
 15  FROM transaction_reversal
 16  );

1170 rows created.

SQL> 
SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #3 : Verify insert of records into the TRANSACTION_REVERSAL table.
SQL> -- --------------------------------------------------------------------------------
SQL> COLUMN "Debit Transactions"  FORMAT A20
SQL> COLUMN "Credit Transactions" FORMAT A20
SQL> COLUMN "All Transactions"	  FORMAT A20
SQL> SELECT   LPAD(TO_CHAR(c1.transaction_count,'99,999'),19,' ') AS "Debit Transactions"
  2  ,	      LPAD(TO_CHAR(c2.transaction_count,'99,999'),19,' ') AS "Credit Transactions"
  3  ,	      LPAD(TO_CHAR(c3.transaction_count,'99,999'),19,' ') AS "All Transactions"
  4  FROM    (SELECT COUNT(*) AS transaction_count FROM transaction WHERE transaction_account = '111-111-111-111') c1 CROSS JOIN
  5  	     (SELECT COUNT(*) AS transaction_count FROM transaction WHERE transaction_account = '222-222-222-222') c2 CROSS JOIN
  6  	     (SELECT COUNT(*) AS transaction_count FROM transaction) c3;
              2,175                1,170                3,345                                                                                         

1 row selected.

SQL> 
SQL> -- --------------------------------------------------------------------------------
SQL> --  Step #4 : Query data.
SQL> -- --------------------------------------------------------------------------------
SQL> -- SQL*Plus formatting instructions.
SQL> SET LINESIZE 9999
SQL> SET PAGESIZE 999
SQL> 
SQL> COLUMN Transaction FORMAT A12
SQL> COLUMN Jan FORMAT A10
SQL> COLUMN Feb FORMAT A10
SQL> COLUMN Mar FORMAT A10
SQL> COLUMN F1Q FORMAT A10
SQL> COLUMN Apr FORMAT A10
SQL> COLUMN May FORMAT A10
SQL> COLUMN Jun FORMAT A10
SQL> COLUMN F2Q FORMAT A10
SQL> COLUMN Jul FORMAT A10
SQL> COLUMN Aug FORMAT A10
SQL> COLUMN Sep FORMAT A10
SQL> COLUMN F3Q FORMAT A10
SQL> COLUMN Oct FORMAT A10
SQL> COLUMN Nov FORMAT A10
SQL> COLUMN Dec FORMAT A10
SQL> COLUMN F4Q FORMAT A10
SQL> COUMUN YTD FORMAT A10
SP2-0734: unknown command beginning "COUMUN YTD..." - rest of line ignored.
SQL> 
SQL> SELECT  transaction_account AS "Transaction"
  2  ,	     january AS "Jan"
  3  ,	     february  AS "Feb"
  4  ,	     march AS "MAR"
  5  ,	     f1q AS "F1Q"
  6  ,	     april AS "APR"
  7  ,	     may AS "May"
  8  ,	     june AS "Jun"
  9  ,	     f2q AS "F2Q"
 10  ,	     july AS "Jul"
 11  ,	     august AS "Aug"
 12  ,	     september AS "Sep"
 13  ,	     f3q     AS "F3Q"
 14  ,	     october AS "Oct"
 15  ,	     november AS "Nov"
 16  ,	     december  AS "Dec"
 17  ,	     f4q  AS "F4Q"
 18  ,	     ytd      AS "YTD"
 19  FROM (
 20  SELECT  CASE
 21  		     WHEN t.transaction_account = '111-111-111-111'
 22  		     THEN 'Debit'
 23  		     WHEN t.transaction_account = '222-222-222-222'
 24  		     THEN 'Credit'
 25  	     END AS "TRANSACTION_ACCOUNT"
 26  ,	     CASE
 27  		     WHEN t.transaction_account = '111-111-111-111'
 28  		     THEN 1
 29  		     WHEN t.transaction_account = '222-222-222-222'
 30  		     THEN 2
 31  	     END AS "SORTKEY"
 32  ,	     LPAD(TO_CHAR
 33  	     (SUM(CASE
 34  		     WHEN EXTRACT(MONTH FROM transaction_date) = 1
 35  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 36  		  THEN
 37  		     CASE
 38  			     WHEN cl.common_lookup_type = 'DEBIT'
 39  			     THEN t.transaction_amount
 40  			     ELSE t.transaction_amount * -1
 41  		     END
 42  		  END),'99,999.00'),10,' ') AS "JANUARY"
 43  ,	     LPAD(TO_CHAR
 44  	     (SUM(CASE
 45  		     WHEN EXTRACT(MONTH FROM transaction_date) = 2
 46  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 47  		  THEN
 48  		     CASE
 49  			     WHEN cl.common_lookup_type = 'DEBIT'
 50  			     THEN t.transaction_amount
 51  			     ELSE t.transaction_amount * -1
 52  		     END
 53  		  END),'99,999.00'),10,' ') AS "FEBRUARY"
 54  ,	     LPAD(TO_CHAR
 55  	     (SUM(CASE
 56  		     WHEN EXTRACT(MONTH FROM transaction_date) = 3
 57  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 58  		  THEN
 59  		     CASE
 60  			     WHEN cl.common_lookup_type = 'DEBIT'
 61  			     THEN t.transaction_amount
 62  			     ELSE t.transaction_amount * -1
 63  		     END
 64  		  END),'99,999.00'),10,' ') AS "MARCH"
 65  ,	     LPAD(TO_CHAR
 66  	     (SUM(CASE
 67  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (1, 2, 3)
 68  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 69  		  THEN
 70  		     CASE
 71  			     WHEN cl.common_lookup_type = 'DEBIT'
 72  			     THEN t.transaction_amount
 73  			     ELSE t.transaction_amount * -1
 74  		     END
 75  		  END),'99,999.00'),10,' ') AS "F1Q"
 76  ,	     LPAD(TO_CHAR
 77  	     (SUM(CASE
 78  		     WHEN EXTRACT(MONTH FROM transaction_date) = 4
 79  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 80  		  THEN
 81  		     CASE
 82  			     WHEN cl.common_lookup_type = 'DEBIT'
 83  			     THEN t.transaction_amount
 84  			     ELSE t.transaction_amount * -1
 85  		     END
 86  		  END),'99,999.00'),10,' ') AS "APRIL"
 87  ,	     LPAD(TO_CHAR
 88  	     (SUM(CASE
 89  		     WHEN EXTRACT(MONTH FROM transaction_date) = 5
 90  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
 91  		  THEN
 92  		     CASE
 93  			     WHEN cl.common_lookup_type = 'DEBIT'
 94  			     THEN t.transaction_amount
 95  			     ELSE t.transaction_amount * -1
 96  		     END
 97  		  END),'99,999.00'),10,' ') AS "MAY"
 98  ,	     LPAD(TO_CHAR
 99  	     (SUM(CASE
100  		     WHEN EXTRACT(MONTH FROM transaction_date) = 6
101  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
102  		  THEN
103  		     CASE
104  			     WHEN cl.common_lookup_type = 'DEBIT'
105  			     THEN t.transaction_amount
106  			     ELSE t.transaction_amount * -1
107  		     END
108  		  END),'99,999.00'),10,' ') AS "JUNE"
109  ,	     LPAD(TO_CHAR
110  	     (SUM(CASE
111  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (4, 5, 6)
112  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
113  		  THEN
114  		     CASE
115  			     WHEN cl.common_lookup_type = 'DEBIT'
116  			     THEN t.transaction_amount
117  			     ELSE t.transaction_amount * -1
118  		     END
119  		  END),'99,999.00'),10,' ') AS "F2Q"
120  ,	     LPAD(TO_CHAR
121  	     (SUM(CASE
122  		     WHEN EXTRACT(MONTH FROM transaction_date) = 7
123  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
124  		  THEN
125  		     CASE
126  			     WHEN cl.common_lookup_type = 'DEBIT'
127  			     THEN t.transaction_amount
128  			     ELSE t.transaction_amount * -1
129  		     END
130  		  END),'99,999.00'),10,' ') AS "JULY"
131  ,	     LPAD(TO_CHAR
132  	     (SUM(CASE
133  		     WHEN EXTRACT(MONTH FROM transaction_date) = 8
134  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
135  		  THEN
136  		     CASE
137  			     WHEN cl.common_lookup_type = 'DEBIT'
138  			     THEN t.transaction_amount
139  			     ELSE t.transaction_amount * -1
140  		     END
141  		  END),'99,999.00'),10,' ') AS "AUGUST"
142  ,	     LPAD(TO_CHAR
143  	     (SUM(CASE
144  		     WHEN EXTRACT(MONTH FROM transaction_date) = 9
145  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
146  		  THEN
147  		     CASE
148  			     WHEN cl.common_lookup_type = 'DEBIT'
149  			     THEN t.transaction_amount
150  			     ELSE t.transaction_amount * -1
151  		     END
152  		  END),'99,999.00'),10,' ') AS "SEPTEMBER"
153  ,	     LPAD(TO_CHAR
154  	     (SUM(CASE
155  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (7, 8, 9)
156  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
157  		  THEN
158  		     CASE
159  			     WHEN cl.common_lookup_type = 'DEBIT'
160  			     THEN t.transaction_amount
161  			     ELSE t.transaction_amount * -1
162  		     END
163  		  END),'99,999.00'),10,' ') AS "F3Q"
164  ,	     LPAD(TO_CHAR
165  	     (SUM(CASE
166  		     WHEN EXTRACT(MONTH FROM transaction_date) = 10
167  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
168  		  THEN
169  		     CASE
170  			     WHEN cl.common_lookup_type = 'DEBIT'
171  			     THEN t.transaction_amount
172  			     ELSE t.transaction_amount * -1
173  		     END
174  		  END),'99,999.00'),10,' ') AS "OCTOBER"
175  ,	     LPAD(TO_CHAR
176  	     (SUM(CASE
177  		     WHEN EXTRACT(MONTH FROM transaction_date) = 11
178  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
179  		  THEN
180  		     CASE
181  			     WHEN cl.common_lookup_type = 'DEBIT'
182  			     THEN t.transaction_amount
183  			     ELSE t.transaction_amount * -1
184  		     END
185  		  END),'99,999.00'),10,' ') AS "NOVEMBER"
186  ,	     LPAD(TO_CHAR
187  	     (SUM(CASE
188  		     WHEN EXTRACT(MONTH FROM transaction_date) = 12
189  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
190  		  THEN
191  		     CASE
192  			     WHEN cl.common_lookup_type = 'DEBIT'
193  			     THEN t.transaction_amount
194  			     ELSE t.transaction_amount * -1
195  		     END
196  		  END),'99,999.00'),10,' ') AS "DECEMBER"
197  ,	     LPAD(TO_CHAR
198  	     (SUM(CASE
199  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (10, 11, 12)
200  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
201  		  THEN
202  		     CASE
203  			     WHEN cl.common_lookup_type = 'DEBIT'
204  			     THEN t.transaction_amount
205  			     ELSE t.transaction_amount * -1
206  		     END
207  		  END),'99,999.00'),10,' ') AS "F4Q"
208  ,	     LPAD(TO_CHAR
209  	     (SUM(CASE
210  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)
211  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
212  		  THEN
213  		     CASE
214  			     WHEN cl.common_lookup_type = 'DEBIT'
215  			     THEN t.transaction_amount
216  			     ELSE t.transaction_amount * -1
217  		     END
218  		  END),'99,999.00'),10,' ') AS "YTD"
219  FROM    transaction t INNER JOIN common_lookup cl
220  ON      t.transaction_type = cl.common_lookup_id
221  WHERE   cl.common_lookup_table = 'TRANSACTION'
222  AND     cl.common_lookup_column = 'TRANSACTION_TYPE'
223  GROUP BY CASE
224  		     WHEN t.transaction_account = '111-111-111-111'
225  		     THEN 'Debit'
226  		     WHEN t.transaction_account = '222-222-222-222'
227  		     THEN 'Credit'
228  	      END
229  ,	      CASE
230  		     WHEN t.transaction_account = '111-111-111-111'
231  		     THEN 1
232  		     WHEN t.transaction_account = '222-222-222-222'
233  		     THEN 2
234  	      END
235  	      UNION ALL SELECT 'Total' AS transaction_account
236  , 3 AS "SORTKEY"
237  ,
238  	      LPAD(TO_CHAR
239  	     (SUM(CASE
240  		     WHEN EXTRACT(MONTH FROM transaction_date) = 1
241  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
242  		  THEN
243  		     CASE
244  			     WHEN cl.common_lookup_type = 'DEBIT'
245  			     THEN t.transaction_amount
246  			     ELSE t.transaction_amount * -1
247  		     END
248  		  END),'99,999.00'),10,' ') AS "JANUARY"
249  ,	     LPAD(TO_CHAR
250  	     (SUM(CASE
251  		     WHEN EXTRACT(MONTH FROM transaction_date) = 2
252  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
253  		  THEN
254  		     CASE
255  			     WHEN cl.common_lookup_type = 'DEBIT'
256  			     THEN t.transaction_amount
257  			     ELSE t.transaction_amount * -1
258  		     END
259  		  END),'99,999.00'),10,' ') AS "FEBRUARY"
260  ,	     LPAD(TO_CHAR
261  	     (SUM(CASE
262  		     WHEN EXTRACT(MONTH FROM transaction_date) = 3
263  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
264  		  THEN
265  		     CASE
266  			     WHEN cl.common_lookup_type = 'DEBIT'
267  			     THEN t.transaction_amount
268  			     ELSE t.transaction_amount * -1
269  		     END
270  		  END),'99,999.00'),10,' ') AS "MARCH"
271  ,	     LPAD(TO_CHAR
272  	     (SUM(CASE
273  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (1, 2, 3)
274  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
275  		  THEN
276  		     CASE
277  			     WHEN cl.common_lookup_type = 'DEBIT'
278  			     THEN t.transaction_amount
279  			     ELSE t.transaction_amount * -1
280  		     END
281  		  END),'99,999.00'),10,' ') AS "F1Q"
282  ,	     LPAD(TO_CHAR
283  	     (SUM(CASE
284  		     WHEN EXTRACT(MONTH FROM transaction_date) = 4
285  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
286  		  THEN
287  		     CASE
288  			     WHEN cl.common_lookup_type = 'DEBIT'
289  			     THEN t.transaction_amount
290  			     ELSE t.transaction_amount * -1
291  		     END
292  		  END),'99,999.00'),10,' ') AS "APRIL"
293  ,	     LPAD(TO_CHAR
294  	     (SUM(CASE
295  		     WHEN EXTRACT(MONTH FROM transaction_date) = 5
296  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
297  		  THEN
298  		     CASE
299  			     WHEN cl.common_lookup_type = 'DEBIT'
300  			     THEN t.transaction_amount
301  			     ELSE t.transaction_amount * -1
302  		     END
303  		  END),'99,999.00'),10,' ') AS "MAY"
304  ,	     LPAD(TO_CHAR
305  	     (SUM(CASE
306  		     WHEN EXTRACT(MONTH FROM transaction_date) = 6
307  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
308  		  THEN
309  		     CASE
310  			     WHEN cl.common_lookup_type = 'DEBIT'
311  			     THEN t.transaction_amount
312  			     ELSE t.transaction_amount * -1
313  		     END
314  		  END),'99,999.00'),10,' ') AS "JUNE"
315  ,	     LPAD(TO_CHAR
316  	     (SUM(CASE
317  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (4, 5, 6)
318  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
319  		  THEN
320  		     CASE
321  			     WHEN cl.common_lookup_type = 'DEBIT'
322  			     THEN t.transaction_amount
323  			     ELSE t.transaction_amount * -1
324  		     END
325  		  END),'99,999.00'),10,' ') AS "F2Q"
326  ,	     LPAD(TO_CHAR
327  	     (SUM(CASE
328  		     WHEN EXTRACT(MONTH FROM transaction_date) = 7
329  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
330  		  THEN
331  		     CASE
332  			     WHEN cl.common_lookup_type = 'DEBIT'
333  			     THEN t.transaction_amount
334  			     ELSE t.transaction_amount * -1
335  		     END
336  		  END),'99,999.00'),10,' ') AS "JULY"
337  ,	     LPAD(TO_CHAR
338  	     (SUM(CASE
339  		     WHEN EXTRACT(MONTH FROM transaction_date) = 8
340  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
341  		  THEN
342  		     CASE
343  			     WHEN cl.common_lookup_type = 'DEBIT'
344  			     THEN t.transaction_amount
345  			     ELSE t.transaction_amount * -1
346  		     END
347  		  END),'99,999.00'),10,' ') AS "AUGUST"
348  ,	     LPAD(TO_CHAR
349  	     (SUM(CASE
350  		     WHEN EXTRACT(MONTH FROM transaction_date) = 9
351  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
352  		  THEN
353  		     CASE
354  			     WHEN cl.common_lookup_type = 'DEBIT'
355  			     THEN t.transaction_amount
356  			     ELSE t.transaction_amount * -1
357  		     END
358  		  END),'99,999.00'),10,' ') AS "SEPTEMBER"
359  ,	     LPAD(TO_CHAR
360  	     (SUM(CASE
361  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (7, 8, 9)
362  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
363  		  THEN
364  		     CASE
365  			     WHEN cl.common_lookup_type = 'DEBIT'
366  			     THEN t.transaction_amount
367  			     ELSE t.transaction_amount * -1
368  		     END
369  		  END),'99,999.00'),10,' ') AS "F3Q"
370  ,	     LPAD(TO_CHAR
371  	     (SUM(CASE
372  		     WHEN EXTRACT(MONTH FROM transaction_date) = 10
373  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
374  		  THEN
375  		     CASE
376  			     WHEN cl.common_lookup_type = 'DEBIT'
377  			     THEN t.transaction_amount
378  			     ELSE t.transaction_amount * -1
379  		     END
380  		  END),'99,999.00'),10,' ') AS "OCTOBER"
381  ,	     LPAD(TO_CHAR
382  	     (SUM(CASE
383  		     WHEN EXTRACT(MONTH FROM transaction_date) = 11
384  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
385  		  THEN
386  		     CASE
387  			     WHEN cl.common_lookup_type = 'DEBIT'
388  			     THEN t.transaction_amount
389  			     ELSE t.transaction_amount * -1
390  		     END
391  		  END),'99,999.00'),10,' ') AS "NOVEMBER"
392  ,	     LPAD(TO_CHAR
393  	     (SUM(CASE
394  		     WHEN EXTRACT(MONTH FROM transaction_date) = 12
395  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
396  		  THEN
397  		     CASE
398  			     WHEN cl.common_lookup_type = 'DEBIT'
399  			     THEN t.transaction_amount
400  			     ELSE t.transaction_amount * -1
401  		     END
402  		  END),'99,999.00'),10,' ') AS "DECEMBER"
403  ,	     LPAD(TO_CHAR
404  	     (SUM(CASE
405  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (10, 11, 12)
406  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
407  		  THEN
408  		     CASE
409  			     WHEN cl.common_lookup_type = 'DEBIT'
410  			     THEN t.transaction_amount
411  			     ELSE t.transaction_amount * -1
412  		     END
413  		  END),'99,999.00'),10,' ') AS "F4Q"
414  ,	     LPAD(TO_CHAR
415  	     (SUM(CASE
416  		     WHEN EXTRACT(MONTH FROM transaction_date) IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)
417  		     AND EXTRACT(YEAR FROM transaction_date) = 2009
418  		  THEN
419  		     CASE
420  			     WHEN cl.common_lookup_type = 'DEBIT'
421  			     THEN t.transaction_amount
422  			     ELSE t.transaction_amount * -1
423  		     END
424  		  END),'99,999.00'),10,' ') AS "YTD"
425  FROM    transaction t INNER JOIN common_lookup cl
426  ON      t.transaction_type = cl.common_lookup_id
427  WHERE   cl.common_lookup_table = 'TRANSACTION'
428  AND     cl.common_lookup_column = 'TRANSACTION_TYPE'
429  ORDER BY SORTKEY);

Transaction  Jan        Feb        MAR        F1Q        APR        May        Jun        F2Q        Jul        Aug        Sep        F3Q        Oct        Nov        Dec        F4Q        YTD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
------------ ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Debit          1,179.00   1,875.00   2,379.00   5,433.00   2,157.00     978.00     534.00   3,669.00   1,050.00     993.00     969.00   3,012.00   1,434.00   1,380.00   1,035.00   3,849.00  15,963.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Credit          -651.00    -996.00  -1,326.00  -2,973.00  -1,125.00    -522.00    -282.00  -1,929.00    -570.00    -522.00    -549.00  -1,641.00    -825.00    -786.00    -567.00  -2,178.00  -8,721.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Total            528.00     879.00   1,053.00   2,460.00   1,032.00     456.00     252.00   1,740.00     480.00     471.00     420.00   1,371.00     609.00     594.00     468.00   1,671.00   7,242.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

3 rows selected.

SQL> 
SQL> SPOOL OFF
